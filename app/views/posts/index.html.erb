<%= render "shared/navbar", notifs: @notifs %>
<%= render "shared/flash" %>
<h1>Title</h1>

<%= render "shared/post_form" %>

<ul>
  <% @posts.each do |post| %>

    <% if post.user == current_user || current_user.friends_with?(post.user) %>
      <div class="box">
        <%= link_to post.author_name, user_path(post.user.id) %>

        <%= button_to "X", 
                    post_path(0),
                    method: :delete,
                    params: { post_id: post.id } %>
        <br>

        <%= post.body %>
        <br>

        <%= post.pretty_time %>
        <br>

        <%= post.display_likes %>
        <% unless post.liked_by?(current_user) %>
          <%= button_to "Like", 
                      likes_path,
                      method: :post,
                      params: { like: {user_id: current_user.id, post_id: post.id} } %>
        <% else %>
          <%= button_to "Unlike", 
                      like_path(0),
                      method: :delete,
                      params: { like: {user_id: current_user.id, post_id: post.id} } %>
        <% end %>

        <%= link_to "Comment", new_comment_path(post_id: post.id) %>

        <% post.comments.each do |comment| %>
          <div class="box">
            <%= link_to comment.author_name, user_path(comment.user.id) %>
            <br>
            <%= comment.body %>

            <%= button_to "Delete", 
                        comment_path(0),
                        method: :delete,
                        params: { comment: {user_id: current_user.id, post_id: post.id} } %>
          </div>
        <% end %>
      </div>

    <% end %>
  <% end %>
</ul>